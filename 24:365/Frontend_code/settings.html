<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì„¤ì • - 24/365</title>
    <link rel="stylesheet" href="settings.css" />
    <link rel="stylesheet" href="header.css" />
    <style>
      #alert-overlay {
        display: none;
      }

      .alert-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(248, 113, 113, 0.2);
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(4px);
      }
      .alert-box {
        background: white;
        padding: 36px 48px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
        border: 3px solid #fca5a5;
      }
      .alert-box h2 {
        color: #b91c1c;
        font-size: 36px;
        margin-bottom: 16px;
      }
      .alert-box button {
        background-color: #f87171;
        color: white;
        border: none;
        padding: 12px 28px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: background-color 0.2s, transform 0.2s;
      }
      .alert-box button:hover {
        background-color: #ef4444;
        transform: translateY(-1px);
      }
    </style>
  </head>
  <body class="no-scroll">
    <header class="header">
      <div class="logo">
        <img src="logo.png" alt="ë¡œê³ " class="logo-img" />
        <span>24/365</span>
      </div>

      <nav class="nav">
        <a href="home.html">ë©”ì¸</a>
        <a href="stats.html">í†µê³„</a>
        <a href="records.html">ê¸°ë¡</a>
      </nav>

      <div class="header-right">
        <img
          src="notice.png"
          alt="ì•Œë¦¼"
          class="icon-img"
          onclick="location.href='alarm.html'"
        />
        <img
          src="setting.png"
          alt="ì„¤ì •"
          class="icon-img"
          onclick="location.href='settings.html'"
        />
        <img
          src="user.png"
          alt="ì‚¬ìš©ì"
          class="icon-img"
          onclick="location.href='user-settings.html'"
        />
      </div>
    </header>

    <main class="main-content-with-sidebar">
      <aside class="settings-sidebar">
        <div class="sidebar-title">
          <img src="setting.png" alt="ì„¤ì •" class="sidebar-title-icon" />
          <span>ì„¤ì •</span>
        </div>
        <div class="sidebar-item active" onclick="showContent('users')">
          <span>ì‚¬ìš©ì ë° ê¶Œí•œ ê´€ë¦¬</span>
        </div>
        <div class="sidebar-item" onclick="showContent('equipment')">
          <span>ì¥ë¹„ ë° ìì› ê´€ë¦¬</span>
        </div>
        <div class="sidebar-item" onclick="showContent('ai-model')">
          <span>AI ëª¨ë¸ ë° ìš´ì˜ ê´€ë¦¬</span>
        </div>
        <div class="sidebar-item" onclick="showContent('system')">
          <span>ì‹œìŠ¤í…œ ìƒíƒœ ë° ì§„ë‹¨</span>
        </div>
      </aside>
      <section class="settings-details-area">
        <div id="users" class="content-section active">
          <div class="content-box">
            <div class="info-item">
              ê¸´ê¸‰ì¡°ì¹˜ ì±…ì„ì: [ëª¨ë¸ ê´€ë¦¬íŒ€] íŒ€ì¥ ê¹€ë‚˜ë¬´
            </div>
            <div class="info-item">(ì—°ë½ì²˜: 010-1234-5678)</div>
            <div class="info-item">
              ì¬í›ˆë ¨ ì‹¤í–‰ ê¶Œí•œ : ìµœê³  ê´€ë¦¬ì ê·¸ë£¹ í•œì •
            </div>
            <div class="info-item">
              ! ê¸°ë¡ ìš”êµ¬ ì‚¬í•­ : ì‹¤í–‰ ì‹œê°„, ì‹¤í–‰ì ê³„ì •, ì‹¤í–‰ ëª…ë ¹ ì „ì²´, ëª¨ë¸
              ë²„ì „, ì¬í›ˆë ¨ ì‚¬ìš© ë°ì´í„°ì…‹ ì„ ë¶ˆë³€ ê¸°ë¡ìœ¼ë¡œ ì¦‰ì‹œ ì €ì¥
            </div>
            <div class="info-item">ìë™ ì‹¤í–‰ ì°¨ë‹¨ ì—¬ë¶€ : í™œì„±</div>
          </div>
        </div>

        <div id="equipment" class="content-section">
          <div class="content-box">
            <div
              class="expandable-item"
              onclick="toggleExpand('webcam-status')"
            >
              <span class="arrow" id="webcam-status-arrow">â–¼</span>
              <span class="expandable-title">ì „ì²´ ì›¹ìº  í˜„í™©</span>
            </div>
            <div class="expandable-content" id="webcam-status-content">
              <div class="info-item">ì „ì²´ ì›¹ìº  í˜„í™©: ì´ 128ëŒ€</div>
              <div class="info-item">ì •ìƒ ì‘ë™ ì¤‘ : 120ëŒ€</div>
              <div class="info-item">ì—°ê²° ì˜¤ë¥˜: 5ëŒ€</div>
              <div class="info-item">ì„œë¹„ìŠ¤ ì ê²€ ì¤‘ : 3ëŒ€</div>
            </div>

            <div class="expandable-item" onclick="toggleExpand('webcam-list')">
              <span class="arrow" id="webcam-list-arrow">â–¶</span>
              <span class="expandable-title">ì›¹ìº  ê´€ë¦¬ ëª©ë¡</span>
            </div>
            <div class="expandable-content collapsed" id="webcam-list-content">
              <div class="info-item">ì›¹ìº  ID: CAM-UIS-001</div>
              <div class="info-item">ì„¤ì¹˜êµ¬ì—­ : ê²½ìƒë¶ë„ ì˜ì„±êµ° ê¸ˆì„±ì‚°</div>
              <div class="info-item">ë‹´ë‹¹ì : ê¹€ë‚˜ë¬´</div>
              <div class="info-item">í˜„ì¬ ìƒíƒœ : ì •ìƒ ì‘ë™ ì¤‘</div>
            </div>

            <div class="info-item static">ë°ì´í„° ë³´ì¡´ ê¸°ê°„ ì„¤ì • : 1ë…„</div>

            <div
              class="expandable-item"
              onclick="toggleExpand('database-status')"
            >
              <span class="arrow" id="database-status-arrow">â–¶</span>
              <span class="expandable-title">ë°ì´í„°ë² ì´ìŠ¤ í˜„í™©</span>
            </div>
            <div
              class="expandable-content collapsed"
              id="database-status-content"
            >
              <div class="info-item">ì „ì²´ ì €ì¥ ê³µê°„: ì´ 100TB</div>
              <div class="info-item">í˜„ì¬ ì‚¬ìš© ê³µê°„: 75 TB</div>
              <div class="info-item">ë°ì´í„° ì¦ê°€ìœ¨ : 2TB</div>
              <div class="info-item">ìµœì¢… ë°±ì—… ì¼ì‹œ: 2025.10.19 12:00:00</div>
            </div>
          </div>
        </div>

        <div id="ai-model" class="content-section">
          <div class="content-box">
            <div class="info-item static">ìµœì¢… ì„±ëŠ¥ ê²€ì¦ì¼ : 2025-09-23</div>

            <div class="expandable-item" onclick="toggleExpand('retraining')">
              <span class="arrow" id="retraining-arrow">â–¼</span>
              <span class="expandable-title">ëª¨ë¸ ì¬í›ˆë ¨ í•„ìš”ì„±</span>
            </div>
            <div class="expandable-content" id="retraining-content">
              <div class="info-item">ëª¨ë¸ ì¬í›ˆë ¨ í•„ìš”ì„± : ë³´í†µ</div>
              <div class="info-item">ê¶Œê³  ì‚¬ìœ  : ì˜¤ë‹´ë¥  5% ì¦ê°€</div>
              <div class="info-item">ë‹¤ìŒ ê¶Œê³  ì‹œì  : 2025. 11.11.ì˜ˆì •</div>
            </div>

            <div class="expandable-item" onclick="toggleExpand('performance')">
              <span class="arrow" id="performance-arrow">â–¶</span>
              <span class="expandable-title">ëª¨ë¸ ì„±ëŠ¥ ì§€í‘œ ì¡°íšŒ</span>
            </div>
            <div class="expandable-content collapsed" id="performance-content">
              <div class="info-item">ì „ì²´ ì •í™•ë„: 95.8%</div>
              <div class="info-item">ì •ë°€ë„: 92.5%</div>
              <div class="info-item">ì¬í˜„ìœ¨: 97.0%</div>
              <div class="info-item">F1-Score: 94.7%</div>
            </div>

            <div class="info-item static">ì‹œìŠ¤í…œ ì†Œí”„íŠ¸ì›¨ì–´ ë²„ì „ : V3.5.2</div>
          </div>
        </div>

        <div id="system" class="content-section">
          <div class="content-box">
            <div class="info-item">ì‹œìŠ¤í…œ ì§„ë‹¨ ê²°ê³¼ : ê¸´ê¸‰ ì¬í›ˆë ¨ í•„ìš”</div>
            <div class="info-item">
              ì£¼ìš” í˜„ìƒ : ë¯¸íƒë¥ /ì˜¤íƒë¥  ë™ì‹œ ê¸‰ì¦, ì˜ˆì¸¡ ê²°ê³¼ì˜ ë¶„ì‚°ë„ ì¦ê°€
            </div>
            <div class="info-item">ì§„ë‹¨ ê·¼ê±° : ì„±ëŠ¥ ì €í•˜ìœ¨: 5.8%,</div>
            <div class="info-item">
              ìµœì‹  ë°ì´í„°ì™€ì˜ ë¶„í¬ ì°¨ì´ ê°’ì´ 0.25 ì´ˆê³¼
            </div>
            <div class="info-item">
              ê¶Œì¥ ì¡°ì¹˜ : ê¸´ê¸‰ ëª¨ë¸ ì¬í›ˆë ¨ ì¦‰ì‹œ ì‹¤í–‰ ë° ì¬ë°°í¬,
            </div>
            <div class="info-item">í›ˆë ¨ ë°ì´í„°ì…‹ ê¸´ê¸‰ ê²€í† </div>
          </div>
        </div>
      </section>
    </main>

    <div id="alert-overlay" class="alert-overlay">
      <div class="alert-box">
        <h2>ğŸ”¥ í™”ì¬ ê°ì§€ ê²½ê³ ! ğŸ”¥</h2>
        <p id="alert-message">
          AI ì„œë²„ì—ì„œ í™”ì¬(FIRE)ë¥¼ ê°ì§€í–ˆìŠµë‹ˆë‹¤! ì¦‰ì‹œ í™•ì¸í•˜ì„¸ìš”!
        </p>
        <button onclick="closeAlert()">í™•ì¸ ë° ê²½ê³  ë„ê¸°</button>
      </div>
    </div>

    <script>
      (function () {
        const SERVER_HOST = "127.0.0.1";
        const SERVER_PORT = 9000;
        const WEBSOCKET_URL = `ws://${SERVER_HOST}:${SERVER_PORT}/ws/detections`;

        const alertOverlay = document.getElementById("alert-overlay");

        function startWebSocket() {
          const socket = new WebSocket(WEBSOCKET_URL);

          socket.onopen = function (e) {
            console.log("[WebSocket Open] FastAPI ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.");
          };

          socket.onmessage = function (event) {
            const detectionData = JSON.parse(event.data);
            console.log("ğŸ”¥ ì‹¤ì‹œê°„ ê°ì§€ ë°ì´í„° ìˆ˜ì‹ :", detectionData);

            const isFire =
              detectionData.is_fire_detected === true ||
              (detectionData.class_name &&
                detectionData.class_name.toUpperCase() === "FIRE");

            if (isFire) {
              showAlert(
                
              );
            }
          };

          socket.onclose = function (event) {
            if (!event.wasClean) {
              setTimeout(startWebSocket, 5000);
            }
          };

          socket.onerror = function (error) {
            console.error("[WebSocket Error]", error);
          };
        }

        function showAlert(message) {
          document.getElementById("alert-message").textContent = message;
          alertOverlay.style.display = "flex";
        }

        window.closeAlert = function () {
          alertOverlay.style.display = "none";
        };

        window.onload = function () {
          startWebSocket();
        };
      })();


      function showContent(sectionId) {
        document.querySelectorAll(".content-section").forEach((section) => {
          section.classList.remove("active");
        });

        document.querySelectorAll(".sidebar-item").forEach((item) => {
          item.classList.remove("active");
        });


        document.getElementById(sectionId).classList.add("active");


        document
          .querySelector(`.sidebar-item[onclick*="${sectionId}"]`)
          .classList.add("active");
      }


      function toggleExpand(id) {
        const content = document.getElementById(id + "-content");
        const arrow = document.getElementById(id + "-arrow");

        if (content.classList.contains("collapsed")) {
          content.classList.remove("collapsed");
          arrow.textContent = "â–¼";
        } else {
          content.classList.add("collapsed");
          arrow.textContent = "â–¶";
        }
      }
    </script>
  </body>
</html>

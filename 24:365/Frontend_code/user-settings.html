<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë‚´ í”„ë¡œí•„ - 24/365</title>
    <link rel="stylesheet" href="user-settings.css" />
    <link rel="stylesheet" href="header.css" />
    <style>
      .alert-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(248, 113, 113, 0.2);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(4px);
      }
      .alert-box {
        background: white;
        padding: 36px 48px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
        border: 3px solid #fca5a5;
      }
      .alert-box h2 {
        color: #b91c1c;
        font-size: 36px;
        margin-bottom: 16px;
      }
      .alert-box button {
        background-color: #f87171;
        color: white;
        border: none;
        padding: 12px 28px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: background-color 0.2s, transform 0.2s;
      }
      .alert-box button:hover {
        background-color: #ef4444;
        transform: translateY(-1px);
      }
    </style>
  </head>
  <body class="no-scroll">
    <header class="header">
      <div class="logo">
        <img src="logo.png" alt="ë¡œê³ " class="logo-img" />
        <span>24/365</span>
      </div>

      <nav class="nav">
        <a href="home.html">ë©”ì¸</a>
        <a href="stats.html">í†µê³„</a>
        <a href="records.html">ê¸°ë¡</a>
      </nav>

      <div class="header-right">
        <img
          src="notice.png"
          alt="ì•Œë¦¼"
          class="icon-img"
          onclick="location.href='alarm.html'"
        />
        <img
          src="setting.png"
          alt="ì„¤ì •"
          class="icon-img"
          onclick="location.href='settings.html'"
        />
        <img
          src="user.png"
          alt="ì‚¬ìš©ì"
          class="icon-img"
          onclick="location.href='user-settings.html'"
        />
      </div>
    </header>

    <main class="main-content-with-sidebar">
      <aside class="settings-sidebar">
        <div class="sidebar-title">
          <img src="user.png" alt="í”„ë¡œí•„" class="sidebar-title-icon" />
          <span>ë‚´ í”„ë¡œí•„</span>
        </div>
        <div class="sidebar-item active" onclick="showContent('account')">
          <img src="1.png" alt="ê³„ì •" class="sidebar-icon" />
          <span>ë‚˜ì˜ ê³„ì • ì •ë³´</span>
        </div>
        <div class="sidebar-item" onclick="showContent('permissions')">
          <img src="2.png" alt="ê¶Œí•œ" class="sidebar-icon" />
          <span>ë‹´ë‹¹ êµ¬ì—­ ë° ê¶Œí•œ</span>
        </div>
        <div class="sidebar-item" onclick="showContent('security')">
          <img src="3.png" alt="ë³´ì•ˆ" class="sidebar-icon" />
          <span>ë³´ì•ˆ ë° ê¸°ìˆ  ì •ë³´</span>
        </div>
      </aside>
      <section class="settings-details-area">
        <div id="account" class="content-section active">
          <div class="content-box">
            <div class="info-item">ì‚¬ìš©ìID : forest_10</div>
            <div class="info-item">ì´ë¦„ : ê¹€ë‚˜ë¬´</div>
            <div class="info-item">ì†Œì† ê¸°ê´€ : ì‚°ë¦¼ì²­ OO ê´€ë¦¬ì†Œ</div>
            <div class="info-item">ì§ì±… / ì§ë¬´ : ì‚°ë¶ˆ ê°ì§€ ë‹´ë‹¹ì</div>
            <div class="info-item">ì´ë©”ì¼ : tree@forest.com</div>
            <div class="info-item">ì „í™”ë²ˆí˜¸ : 010-1234-5678</div>
          </div>
        </div>

        <div id="permissions" class="content-section">
          <div class="content-box">
            <div class="info-item">
              í˜„ì¬ ë‹´ë‹¹ êµ¬ì—­ : ê²½ìƒë¶ë„ ì˜ì„±êµ° OO ê´€ë¦¬ì†Œ
            </div>
            <div class="info-item">ê´€í•  êµ¬ì—­ ì½”ë“œ : UIS-020-B</div>
            <div class="info-item">ì´ ê´€ë¦¬ ë©´ì  : 7,200 ha</div>
            <div class="info-item">ì´ í• ë‹¹ ì›¹ìº  ìˆ˜ : Nê°œ</div>
            <div class="info-item">í˜„ì¬ ê¶Œí•œ ë ˆë²¨ : ì‚°ë¶ˆ ê°ì§€ ë‹´ë‹¹ì</div>
            <div class="info-item">
              ì£¼ìš” ê¸°ëŠ¥ ì ‘ê·¼ ê¶Œí•œ : ì•Œë¦¼ ìŠ¹ì¸ ë° ì²˜ë¦¬, ì›¹ìº  ëª¨ë‹ˆí„°ë§, í†µê³„
              ë°ì´í„° ì—´ëŒ
            </div>
          </div>
        </div>

        <div id="security" class="content-section">
          <div class="content-box">
            <div class="info-item">2ë‹¨ê³„ ì¸ì¦ ì„¤ì •</div>
            <div class="info-item">ìµœê·¼ ë¡œê·¸ì¸ ê¸°ë¡ : 2025.10.29 08:30</div>
            <div class="info-item">ì ìš© AI ëª¨ë¸ ë²„ì „ : YOLOv11</div>
            <div class="info-item">ëª¨ë¸ í›ˆë ¨ í™˜ê²½ : H100</div>
            <div class="info-item">ì‹œìŠ¤í…œ ìµœì¢… ì—…ë°ì´íŠ¸ : 2025ë…„ 10ì›” 25ì¼</div>
          </div>
        </div>
      </section>
    </main>

    <div id="alert-overlay" class="alert-overlay">
      <div class="alert-box">
        <h2>ğŸ”¥ í™”ì¬ ê°ì§€ ê²½ê³ ! ğŸ”¥</h2>
        <p id="alert-message">
          AI ì„œë²„ì—ì„œ í™”ì¬(FIRE)ë¥¼ ê°ì§€í–ˆìŠµë‹ˆë‹¤! ì¦‰ì‹œ í™•ì¸í•˜ì„¸ìš”!
        </p>
        <button onclick="closeAlert()">í™•ì¸ ë° ê²½ê³  ë„ê¸°</button>
      </div>
    </div>

    <script>
      (function () {
        const SERVER_HOST = "127.0.0.1";
        const SERVER_PORT = 9000;
        const WEBSOCKET_URL = `ws://${SERVER_HOST}:${SERVER_PORT}/ws/detections`;

        const alertOverlay = document.getElementById("alert-overlay");

        function startWebSocket() {
          const socket = new WebSocket(WEBSOCKET_URL);

          socket.onopen = function (e) {
            console.log("[WebSocket Open] FastAPI ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.");
          };

          socket.onmessage = function (event) {
            const detectionData = JSON.parse(event.data);
            console.log("ğŸ”¥ ì‹¤ì‹œê°„ ê°ì§€ ë°ì´í„° ìˆ˜ì‹ :", detectionData);

            const isFire =
              detectionData.is_fire_detected === true ||
              (detectionData.class_name &&
                detectionData.class_name.toUpperCase() === "FIRE");

            if (isFire) {
              showAlert(
                
              );
            }
          };

          socket.onclose = function (event) {
            if (!event.wasClean) {
              setTimeout(startWebSocket, 5000);
            }
          };

          socket.onerror = function (error) {
            console.error("[WebSocket Error]", error);
          };
        }

        function showAlert(message) {
          document.getElementById("alert-message").textContent = message;
          alertOverlay.style.display = "flex";
        }

        window.closeAlert = function () {
          alertOverlay.style.display = "none";
        };

        window.onload = function () {
          startWebSocket();
        };
      })();

      function showContent(sectionId) {
        document.querySelectorAll(".content-section").forEach((section) => {
          section.classList.remove("active");
        });

        document.querySelectorAll(".sidebar-item").forEach((item) => {
          item.classList.remove("active");
        });

        document.getElementById(sectionId).classList.add("active");

        event.currentTarget.classList.add("active");
      }
    </script>
  </body>
</html>
